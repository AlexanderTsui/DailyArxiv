<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DailyArxiv · {{ report.date }}</title>
    <style>
      :root{
        --bg:#0b1020;
        --panel:#0f172a;
        --card:#0b1226;
        --ink:#e5e7eb;
        --muted:#9ca3af;
        --border:rgba(148,163,184,.22);
        --shadow:0 18px 40px rgba(0,0,0,.35);
        --accent:#7c3aed;
        --accent2:#22c55e;
        --warn:#f59e0b;
        --chip:rgba(148,163,184,.12);
        --chip2:rgba(124,58,237,.16);
        --good:rgba(34,197,94,.16);
        --danger:rgba(239,68,68,.16);
      }

      @page{
        size:A4;
        margin:14mm 12mm 16mm 12mm;
        @bottom-center{
          content:"DailyArxiv · " counter(page) " / " counter(pages);
          color:#94a3b8;
          font-size:10px;
          font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Arial, "Microsoft YaHei", sans-serif;
        }
      }

      *{box-sizing:border-box}
      body{
        margin:0;
        background:radial-gradient(1200px 600px at 20% -10%, rgba(124,58,237,.28), transparent 60%),
                   radial-gradient(900px 500px at 90% 0%, rgba(34,197,94,.18), transparent 55%),
                   var(--bg);
        color:var(--ink);
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Arial, "Microsoft YaHei", sans-serif;
        line-height:1.45;
      }
      a{color:inherit; text-decoration:none; border-bottom:1px dotted rgba(148,163,184,.45)}
      .shell{max-width:1100px; margin:28px auto; padding:0 16px 56px}
      .page{
        width:min(210mm, 100%);
        margin:0 auto 22px;
        background:linear-gradient(180deg, rgba(15,23,42,.90), rgba(15,23,42,.72));
        border:1px solid var(--border);
        border-radius:16px;
        box-shadow:var(--shadow);
        overflow:hidden;
        padding:18mm 16mm;
      }
      .page-break{break-after:page; page-break-after:always}

      .hero{
        display:flex;
        gap:14px;
        align-items:flex-start;
        justify-content:space-between;
        padding-bottom:14px;
        border-bottom:1px solid var(--border);
        margin-bottom:14px;
      }
      .hero h1{margin:0; font-size:26px; letter-spacing:-.3px}
      .hero .sub{
        margin-top:6px;
        color:var(--muted);
        font-size:12.5px;
      }
      .hero .meta{
        text-align:right;
        color:var(--muted);
        font-size:12px;
        line-height:1.35;
        min-width: 240px;
      }
      .chips{display:flex; flex-wrap:wrap; gap:8px; list-style:none; padding:0; margin:10px 0 0}
      .chip{
        display:inline-flex; gap:6px; align-items:center;
        padding:6px 10px;
        border:1px solid var(--border);
        background:var(--chip);
        border-radius:999px;
        font-size:12px;
        color:var(--ink);
      }
      .chip b{font-weight:700}
      .chip.p{background:var(--chip2)}

      .grid{
        display:grid;
        grid-template-columns: 1fr 1fr;
        gap:12px;
        margin-top:12px;
      }
      .card{
        border:1px solid var(--border);
        background:rgba(11,18,38,.55);
        border-radius:16px;
        padding:12px 12px 10px;
        break-inside:avoid;
        page-break-inside:avoid;
      }
      .card h3{margin:0 0 6px; font-size:14px; letter-spacing:-.15px}
      .card .sub{color:var(--muted); font-size:11.5px; margin:0 0 10px}
      .row{display:flex; flex-wrap:wrap; gap:6px; margin:0 0 10px}
      .pill{
        display:inline-flex; align-items:center; gap:6px;
        padding:5px 9px;
        border-radius:999px;
        border:1px solid var(--border);
        background:rgba(148,163,184,.10);
        font-size:11px;
        color:var(--ink);
        white-space:nowrap;
      }
      .pill.good{background:var(--good)}
      .pill.warn{background:rgba(245,158,11,.16)}
      .pill.bad{background:var(--danger)}
      .dot{width:7px; height:7px; border-radius:50%; background:rgba(148,163,184,.85)}
      .pill.good .dot{background:rgba(34,197,94,.95)}
      .pill.warn .dot{background:rgba(245,158,11,.95)}

      .k{color:var(--muted); font-size:11px; letter-spacing:.2px; text-transform:uppercase; margin-bottom:6px}
      .box{
        border:1px solid var(--border);
        background:rgba(148,163,184,.08);
        border-radius:14px;
        padding:10px 10px 8px;
        margin:0 0 10px;
      }
      .box p{margin:0; font-size:13px}
      .box.m{background:rgba(124,58,237,.10)}
      .box.g{background:rgba(34,197,94,.10)}
      .why{
        border-top:1px dashed rgba(148,163,184,.35);
        padding-top:10px;
      }
      .why p{margin:0; font-size:13px}

      .section-title{
        margin:18px 0 10px;
        font-size:15px;
        letter-spacing:-.15px;
      }

      .lede{
        display:grid;
        grid-template-columns: 1.2fr .8fr;
        gap:12px;
      }
      .panel{
        border:1px solid var(--border);
        background:rgba(11,18,38,.55);
        border-radius:16px;
        padding:12px 12px 10px;
      }
      .panel p{margin:0; font-size:13.5px}
      .panel ol{margin:0; padding-left:18px}
      .panel li{margin:0 0 8px; font-size:13px}

      .trend-grid{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
      .range{margin:0 0 10px; color:var(--muted); font-size:11.5px}
      .bars{display:grid; gap:8px; margin-top:10px}
      .bar{display:grid; grid-template-columns: 1fr 120px; gap:10px; align-items:center}
      .track{height:9px; background:rgba(148,163,184,.12); border:1px solid var(--border); border-radius:999px; overflow:hidden}
      .fill{height:100%; background:linear-gradient(90deg, var(--accent), #60a5fa)}
      .w{font-size:11.5px; color:var(--muted); text-align:right; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

      @media (max-width: 860px){
        .grid{grid-template-columns:1fr}
        .lede{grid-template-columns:1fr}
        .hero{flex-direction:column}
        .hero .meta{text-align:left; min-width:0}
        .trend-grid{grid-template-columns:1fr}
      }
      @media print{
        body{background:#fff; color:#111827}
        a{border-bottom:none}
        .page{box-shadow:none; background:#fff}
        .chip,.pill,.box,.panel,.card{border-color:#e5e7eb}
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <section class="page page-break">
        <header class="hero">
          <div>
            <h1>DailyArxiv · {{ report.date }}</h1>
            <div class="sub">
              区间：{{ report.source_range_start }} ~ {{ report.source_range_end }}
              · 领域：{{ report.domain }}
            </div>
            <ul class="chips">
              {% for c in report.categories %}
              <li class="chip"><b>分区</b> {{ c }}</li>
              {% endfor %}
              {% for k in report.keywords %}
              <li class="chip p"><b>关键词</b> {{ k }}</li>
              {% endfor %}
            </ul>
          </div>
          <div class="meta">
            生成时间：{{ report.generated_at }}<br />
            论文数：{{ report.papers | length }}
          </div>
        </header>

        <div class="lede">
          <section class="panel">
            <div class="k">Global Trend</div>
            <p>{{ report.global_trend }}</p>
          </section>
          <section class="panel">
            <div class="k">Top Picks</div>
            <ol>
              {% for p in report.papers[:3] %}
              <li>
                <div style="font-weight:700">{{ p.title_cn or p.title_en }}</div>
                <div style="color:var(--muted); font-size:11.5px">arXiv: {{ p.id }} · {{ p.primary_category }}</div>
              </li>
              {% endfor %}
            </ol>
          </section>
        </div>

        <h2 class="section-title">精选论文 · Selected Papers</h2>
        <div class="grid">
          {% for p in report.papers %}
          <article class="card">
            <h3>{{ p.title_cn or p.title_en }}</h3>
            <div class="sub">
              arXiv: <a href="{{ p.url }}">{{ p.id }}</a>
              · {{ p.primary_category }}
              · {{ p.publish_date }}
              <br/>
              {% set affs = p.affiliations | default([]) %}
              单位：{% if affs %}{{ affs | join("；") }}{% else %}—{% endif %}
            </div>
            <div class="row">
              <span class="pill"><span class="dot"></span>{{ p.primary_category }}</span>
              <span class="pill good"><span class="dot"></span>相关度 {{ p.relevance.relevance_score }}</span>
              <span class="pill warn"><span class="dot"></span>推荐度 {{ p.score }}/5</span>
              <span class="pill"><span class="dot"></span>{{ p.paradigm_relation }}</span>
            </div>
            <div class="box m">
              <div class="k">Motivation</div>
              <p>{{ p.motivation }}</p>
            </div>
            <div class="box g">
              <div class="k">Method</div>
              <p>{{ p.method }}</p>
            </div>
            <div class="box">
              <div class="k">Abstract · 摘要翻译</div>
              {% set s = (p.summary_cn | default("") | trim) %}
              <p>{{ s if s else "（无）" }}</p>
            </div>
            <div class="why">
              <div class="k">Why selected</div>
              <p>命中：{{ p.relevance.matched_terms | join(" / ") }}。{{ p.relevance.reason_cn }}</p>
            </div>
          </article>
          {% endfor %}
        </div>
      </section>

      <section class="page">
        <h2 class="section-title" style="margin-top:0">本周 / 本月趋势 · Trends</h2>
        <div class="trend-grid">
          <section class="panel">
            <div class="k">Weekly</div>
            {% if report.weekly_trend %}
            <div class="range">{{ report.weekly_trend.start_date }} ~ {{ report.weekly_trend.end_date }}</div>
            <p>{{ report.weekly_trend.summary_cn }}</p>
            <div class="bars">
              {% for kw in report.weekly_trend.keywords %}
              <div class="bar">
                <div class="track"><div class="fill" style="width: {{ (kw.weight * 100) | round(0) }}%"></div></div>
                <div class="w">{{ kw.keyword }}</div>
              </div>
              {% endfor %}
            </div>
            {% else %}
            <div class="range">（未启用）</div>
            {% endif %}
          </section>

          <section class="panel">
            <div class="k">Monthly</div>
            {% if report.monthly_trend %}
            <div class="range">{{ report.monthly_trend.start_date }} ~ {{ report.monthly_trend.end_date }}</div>
            <p>{{ report.monthly_trend.summary_cn }}</p>
            <div class="bars">
              {% for kw in report.monthly_trend.keywords %}
              <div class="bar">
                <div class="track"><div class="fill" style="width: {{ (kw.weight * 100) | round(0) }}%"></div></div>
                <div class="w">{{ kw.keyword }}</div>
              </div>
              {% endfor %}
            </div>
            {% else %}
            <div class="range">（未启用）</div>
            {% endif %}
          </section>
        </div>
      </section>
    </div>
  </body>
</html>
