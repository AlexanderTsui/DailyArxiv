<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DailyArxiv · {{ report.date }} · Compact</title>
    <style>
      :root{
        --paper:#ffffff;
        --ink:#111827;
        --muted:#6b7280;
        --border:#e5e7eb;
        --chip:#f3f4f6;
        --shadow:0 10px 22px rgba(17,24,39,.08);
        --accent:#2563eb;
        --good:#16a34a;
        --warn:#d97706;
      }
      @page{
        size:A4;
        margin:14mm 12mm 16mm 12mm;
        @bottom-center{
          content:"DailyArxiv · {{ report.date }} · " counter(page) " / " counter(pages);
          color:#9ca3af;
          font-size:10px;
          font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Arial, "Microsoft YaHei", sans-serif;
        }
      }
      *{box-sizing:border-box}
      body{
        margin:0;
        background:#f5f6f8;
        color:var(--ink);
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Arial, "Microsoft YaHei", sans-serif;
        line-height:1.45;
      }
      a{color:inherit; text-decoration:none; border-bottom:1px dotted #cbd5e1}
      .shell{max-width: 1100px; margin:28px auto; padding:0 16px 56px}
      .page{
        width:min(210mm, 100%);
        margin:0 auto 22px;
        background:var(--paper);
        border:1px solid var(--border);
        border-radius:12px;
        box-shadow:var(--shadow);
        overflow:hidden;
        padding:18mm 14mm;
      }
      .page-break{break-after:page; page-break-after:always}

      .top{
        display:flex;
        justify-content:space-between;
        gap:14px;
        padding-bottom:10px;
        border-bottom:1px solid var(--border);
        margin-bottom:12px;
      }
      .top h1{margin:0; font-size:20px; letter-spacing:-.2px}
      .top .meta{color:var(--muted); font-size:11.5px; text-align:right; line-height:1.35}
      .chips{display:flex; flex-wrap:wrap; gap:6px; margin:10px 0 0; padding:0; list-style:none}
      .chip{
        display:inline-flex; gap:6px; align-items:center;
        padding:4px 8px;
        border:1px solid var(--border);
        border-radius:999px;
        background:var(--chip);
        font-size:11px;
        color:#374151;
      }
      .chip b{font-weight:700}

      .lede{
        border:1px solid var(--border);
        border-radius:12px;
        padding:10px 10px 9px;
        background:#fbfdff;
      }
      .lede .k{color:var(--muted); font-size:11px; text-transform:uppercase; letter-spacing:.35px; margin:0 0 6px}
      .lede p{margin:0; font-size:13px}

      .section-title{
        margin:14px 0 10px;
        font-size:14px;
        letter-spacing:-.1px;
      }

      table{
        width:100%;
        border-collapse:separate;
        border-spacing:0;
        border:1px solid var(--border);
        border-radius:12px;
        overflow:hidden;
        font-size:12px;
      }
      thead th{
        background:#f8fafc;
        color:#334155;
        text-align:left;
        font-size:11px;
        letter-spacing:.35px;
        text-transform:uppercase;
        padding:10px 10px;
        border-bottom:1px solid var(--border);
        font-weight:700;
      }
      tbody td{
        vertical-align:top;
        padding:10px 10px;
        border-bottom:1px solid var(--border);
      }
      tbody tr:last-child td{border-bottom:0}

      .title{
        font-weight:800;
        letter-spacing:-.1px;
        margin:0 0 6px;
        font-size:12.5px;
      }
      .sub{
        color:var(--muted);
        font-size:11px;
        margin:0 0 8px;
      }
      .badges{display:flex; flex-wrap:wrap; gap:6px}
      .badge{
        display:inline-flex; align-items:center; gap:6px;
        padding:4px 8px;
        border-radius:999px;
        border:1px solid var(--border);
        background:#fff;
        font-size:11px;
        white-space:nowrap;
      }
      .dot{width:7px; height:7px; border-radius:50%; background:#94a3b8}
      .badge.good .dot{background:var(--good)}
      .badge.warn .dot{background:var(--warn)}
      .badge.tag{background:#f8fafc}

      .mini{
        margin:0;
        color:#111827;
        font-size:12px;
        line-height:1.4;
      }
      .muted{color:var(--muted)}

      .trend-grid{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
      .trend{
        border:1px solid var(--border);
        border-radius:12px;
        padding:10px 10px 9px;
        background:#ffffff;
      }
      .range{margin:0 0 8px; color:var(--muted); font-size:11px}
      .bars{display:grid; gap:8px; margin-top:10px}
      .bar{display:grid; grid-template-columns: 1fr 120px; gap:10px; align-items:center}
      .track{height:9px; background:#eef2ff; border:1px solid #e5e7eb; border-radius:999px; overflow:hidden}
      .fill{height:100%; background:linear-gradient(90deg, var(--accent), #60a5fa)}
      .w{font-size:11px; color:var(--muted); text-align:right; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

      @media (max-width: 900px){
        .top{flex-direction:column}
        .top .meta{text-align:left}
        .trend-grid{grid-template-columns:1fr}
        table{font-size:11.5px}
      }
      @media print{
        body{background:#fff}
        .page{box-shadow:none}
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <section class="page page-break">
        <header class="top">
          <div>
            <h1>DailyArxiv · {{ report.date }}（紧凑版）</h1>
            <ul class="chips">
              {% for c in report.categories %}
              <li class="chip"><b>分区</b> {{ c }}</li>
              {% endfor %}
              {% for k in report.keywords %}
              <li class="chip"><b>关键词</b> {{ k }}</li>
              {% endfor %}
            </ul>
          </div>
          <div class="meta">
            生成：{{ report.generated_at }}<br/>
            区间：{{ report.source_range_start }} ~ {{ report.source_range_end }}<br/>
            论文：{{ report.papers | length }} 篇
          </div>
        </header>

        <section class="lede">
          <div class="k">Global Trend</div>
          <p>{{ report.global_trend }}</p>
        </section>

        <h2 class="section-title">精选论文 · Selected Papers</h2>
        <table>
          <thead>
            <tr>
              <th style="width: 42%">论文</th>
              <th style="width: 22%">标签</th>
              <th style="width: 36%">摘要要点（Motivation / Method / Why）</th>
            </tr>
          </thead>
          <tbody>
            {% for p in report.papers %}
            <tr>
              <td>
                <div class="title">{{ p.title_cn or p.title_en }}</div>
                <div class="sub">
                  arXiv: <a href="{{ p.url }}">{{ p.id }}</a> · {{ p.primary_category }} · {{ p.publish_date }}
                  <br/>
                  {% set affs = p.affiliations | default([]) %}
                  单位：{% if affs %}{{ affs | join("；") }}{% else %}—{% endif %}
                </div>
                <div class="badges">
                  <span class="badge good"><span class="dot"></span>相关度 {{ p.relevance.relevance_score }}</span>
                  <span class="badge warn"><span class="dot"></span>推荐度 {{ p.score }}/5</span>
                  <span class="badge tag"><span class="dot"></span>{{ p.paradigm_relation }}</span>
                </div>
              </td>
              <td>
                <p class="mini">
                  <span class="muted">作者：</span>{{ p.authors | join(", ") }}<br/>
                  <span class="muted">分区：</span>{{ p.primary_category }}
                </p>
              </td>
              <td>
                <p class="mini"><span class="muted">Motivation：</span>{{ p.motivation }}</p>
                <p class="mini" style="margin-top:8px"><span class="muted">Method：</span>{{ p.method }}</p>
                <p class="mini" style="margin-top:8px"><span class="muted">摘要翻译：</span>{{ (p.summary_cn | default("") | trim) or "（无）" }}</p>
                <p class="mini" style="margin-top:8px"><span class="muted">Why：</span>命中 {{ p.relevance.matched_terms | join(" / ") }}；{{ p.relevance.reason_cn }}</p>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>

      <section class="page">
        <h2 class="section-title" style="margin-top:0">本周 / 本月趋势 · Trends</h2>
        <div class="trend-grid">
          <section class="trend">
            <div class="k">Weekly</div>
            {% if report.weekly_trend %}
            <div class="range">{{ report.weekly_trend.start_date }} ~ {{ report.weekly_trend.end_date }}</div>
            <p class="mini">{{ report.weekly_trend.summary_cn }}</p>
            <div class="bars">
              {% for kw in report.weekly_trend.keywords %}
              <div class="bar">
                <div class="track"><div class="fill" style="width: {{ (kw.weight * 100) | round(0) }}%"></div></div>
                <div class="w">{{ kw.keyword }}</div>
              </div>
              {% endfor %}
            </div>
            {% else %}
            <div class="range">（未启用）</div>
            {% endif %}
          </section>
          <section class="trend">
            <div class="k">Monthly</div>
            {% if report.monthly_trend %}
            <div class="range">{{ report.monthly_trend.start_date }} ~ {{ report.monthly_trend.end_date }}</div>
            <p class="mini">{{ report.monthly_trend.summary_cn }}</p>
            <div class="bars">
              {% for kw in report.monthly_trend.keywords %}
              <div class="bar">
                <div class="track"><div class="fill" style="width: {{ (kw.weight * 100) | round(0) }}%"></div></div>
                <div class="w">{{ kw.keyword }}</div>
              </div>
              {% endfor %}
            </div>
            {% else %}
            <div class="range">（未启用）</div>
            {% endif %}
          </section>
        </div>
      </section>
    </div>
  </body>
</html>
